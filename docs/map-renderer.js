(()=>{"use strict";var t={407:function(t,s,i){var e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0});const h=e(i(847)),a="ðŸš©ï¸";function n(t,{text:s,x:i,z:e,size:h}){t.lineWidth=Math.round(.2*h),t.strokeStyle="rgba(0, 0, 0, 0.8)",t.strokeText(s,i,e),t.lineWidth=Math.round(.1*h),t.strokeStyle="white",t.strokeText(s,i,e),t.fillText(s,i,e)}s.default=class{constructor(t){this.canvas=t,this.showBiomes=!0,this.showSplat3=!0,this.showSplat4=!0,this.showRad=!0,this.showPrefabs=!0,this.biomesImg=null,this.splat3Img=null,this.splat4Img=null,this.radImg=null,this.brightness="100%",this.scale=.1,this.signSize=200,this.prefabs=[];const s=new FontFace("Noto Sans","url(NotoEmoji-Regular.ttf)");s.load().then((t=>fonts.add(t))),this.fontFace=s.load(),this.markCoords=null,this.throttledUpdater=h.default((()=>this.updateImmediately()))}get width(){return Math.max(this.biomesImg?this.biomesImg.width:0,this.splat3Img?this.splat3Img.width:0,this.splat4Img?this.splat4Img.width:0)}get height(){return Math.max(this.biomesImg?this.biomesImg.height:0,this.splat3Img?this.splat3Img.height:0,this.splat4Img?this.splat4Img.height:0)}update(){this.throttledUpdater()}async updateImmediately(){this.canvas.width=this.width*this.scale,this.canvas.height=this.height*this.scale;const t=this.canvas.getContext("2d");t&&(t.scale(this.scale,this.scale),t.filter=`brightness(${this.brightness})`,this.biomesImg&&this.showBiomes&&t.drawImage(this.biomesImg,0,0,this.width,this.height),this.splat3Img&&this.showSplat3&&t.drawImage(this.splat3Img,0,0,this.width,this.height),this.splat4Img&&this.showSplat4&&t.drawImage(this.splat4Img,0,0,this.width,this.height),t.filter="none",this.radImg&&this.showRad&&(t.imageSmoothingEnabled=!1,t.drawImage(this.radImg,0,0,this.width,this.height),t.imageSmoothingEnabled=!0),this.showPrefabs&&await async function(t,s){s.font=`${t.signSize}px ${(await t.fontFace).family}`,s.fillStyle="red",s.textAlign="center",s.textBaseline="middle";const i=t.width/2,e=t.height/2,h=Math.round(.01*t.signSize),a=Math.round(.05*t.signSize);for(let o=t.prefabs.length-1;o>=0;o-=1){const l=t.prefabs[o];n(s,{text:"âœ˜",x:i+l.x+h,z:e-l.z+a,size:t.signSize})}}(this,t),this.markCoords&&await async function(t,s){if(!t.markCoords)return;s.font=`${t.signSize}px ${(await t.fontFace).family}`,s.fillStyle="red",s.textAlign="left",s.textBaseline="alphabetic";const i=t.width/2,e=t.height/2,h=-1*Math.round(.32*t.signSize),o=-1*Math.round(.1*t.signSize),l=i+t.markCoords.x+h,r=e-t.markCoords.z+o;n(s,{text:a,x:l,z:r,size:t.signSize}),s.strokeText(a,l,r),s.fillText(a,l,r)}(this,t))}}},847:(t,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(t){let s=null,i=null;return async()=>{s=!0,i||(i=(async()=>{for(;s;)s=!1,await t(),await new Promise((t=>requestAnimationFrame(t)));i=null})())}}},496:function(t,s,i){var e=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(s,"__esModule",{value:!0});const h=e(i(407));let a;onmessage=t=>{const{canvas:s,...i}=t.data;s&&(a?a.canvas=s:a=new h.default(s)),Object.assign(a,i),postMessage({mapSizes:{width:a.width,height:a.height}}),a.update()}}},s={};!function i(e){var h=s[e];if(void 0!==h)return h.exports;var a=s[e]={exports:{}};return t[e].call(a.exports,a,a.exports,i),a.exports}(496)})();
//# sourceMappingURL=map-renderer.js.map