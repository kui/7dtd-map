"use strict";(()=>{function p(n,e=()=>`Unexpected state: ${String(n)}`){if(n==null)throw Error(e());return n}function x(n,e,t=()=>`Unexpected type: expected as ${String(e)}, but actual type ${String(n)}`){if(n instanceof e)return n;throw Error(t())}function g(n,e){let t=p(n,()=>"Unexpected argument: id is null"),r=p(document.getElementById(t),()=>`Element not found: #${t}`);return e?x(r,e):r}function o(n){console.error("%o",n)}async function d(n){let e=await fetch(n);if(!e.ok)throw Error(`Failed to fetch ${n}: ${e.statusText}`);return await e.json()}var b=["english","german","spanish","french","italian","japanese","koreana","polish","brazilian","russian","turkish","schinese","tchinese"],M={en:"english",de:"german",es:"spanish",fr:"french",it:"italian",ja:"japanese",ko:"koreana",pl:"polish",pt:"brazilian",ru:"russian",tr:"turkish","zh-CN":"schinese","zh-TW":"tchinese"},f=["blocks","prefabs","shapes"],s=class n{static DEFAULT_LANGUAGE="english";#e;#t;#n;#r;constructor(e,t){this.#e=e,this.#t=h(t),this.#n=new Map(f.map(r=>[r,this.#s(n.DEFAULT_LANGUAGE,r)])),this.#r=this.#a()}get(e){let t=this.#r.get(e);if(!t)throw new Error(`No labels for ${this.#t}/${e}`);return t}set language(e){e!==this.#t&&(console.log("LabelHolder set language: %s -> %s",this.#t,e),this.#t=e,this.#r=this.#a())}#a(){return new Map(f.map(e=>[e,this.#o(e)]))}async#o(e){let t=this.#n.get(e);if(!t)throw new Error(`No fallback for ${this.#t}/${e}`);return new c(await this.#s(this.#t,e),await t)}async#s(e,t){return new Map(Object.entries(await d(`${this.#e}/${e}/${t}.json`)))}},c=class{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get(e){return this.#e.get(e)??this.#t.get(e)}};function h(n){for(let e of n)for(let[t,r]of Object.entries(M))if(e.startsWith(t))return r;return s.DEFAULT_LANGUAGE}var i=class extends Error{#e;constructor(e){super("Multiple errors occurred"),this.#e=e}get causes(){return this.#e}};var l=class{#e=[];addListener(e){this.#e.push(e)}removeListener(e){let t=this.#e.indexOf(e);t>=0&&this.#e.splice(t,1)}async dispatch(e){let r=(await Promise.allSettled(this.#e.map(a=>a(e)))).flatMap(a=>a.status==="rejected"?[a.reason]:[]);if(r.length===1)throw r[0];if(r.length>1)throw new i(r)}dispatchNoAwait(e){this.dispatch(e).catch(o)}};var u=class{#e;#t=new l;#n;constructor(e,t,r){this.#e=e,this.#n=new s(t,r),this.#r(r),this.#e.language.addEventListener("change",()=>{let a=this.#e.language.value;a!==localStorage.getItem("language")&&(localStorage.setItem("language",a),this.holder.language=a,this.#t.dispatchNoAwait({update:{lang:a}}))})}#r(e){let t=new Set(Array.from(this.#e.language.options).map(a=>a.value));for(let a of b){if(t.has(a))continue;let m=document.createElement("option");m.textContent=a,this.#e.language.appendChild(m)}let r=localStorage.getItem("language")??h(e);this.#e.language.value!==r&&(this.#e.language.value=r,requestAnimationFrame(()=>this.#e.language.dispatchEvent(new Event("change"))))}addListener(e){this.#t.addListener(e)}get language(){return this.#e.language.value}get holder(){return this.#n}};function L(){let n=new u({language:g("label_lang",HTMLSelectElement)},"../labels",navigator.languages),e=n.holder;n.addListener(async()=>{w(await e.get("prefabs")),E(await e.get("blocks"),await e.get("shapes"))}),(async()=>{w(await e.get("prefabs")),E(await e.get("blocks"),await e.get("shapes"))})().catch(o)}function w(n){let e=document.querySelector(".prefab_name")?.textContent?.trim();if(!e)return;let t=document.querySelector(".prefab_label");t&&(t.textContent=n.get(e)??"-")}function E(n,e){for(let t of g("blocks",HTMLElement).querySelectorAll(".block")){let r=t.querySelector(".block_name")?.textContent?.trim();if(!r)continue;let a=t.querySelector(".block_label");a&&(a.textContent=n.get(r)??e.get(r)??"-")}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",L):L();})();
//# sourceMappingURL=main.js.map
